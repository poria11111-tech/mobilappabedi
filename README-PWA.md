# PWA آماده برای PWABuilder

این بسته شامل فایل‌های لازم برای PWA است تا بتوانید در https://www.pwabuilder.com بررسی و سپس خروجی اندروید بگیرید.

## فایل‌ها
- `manifest.json` — تنظیمات PWA (نام، آیکن‌ها، رنگ‌ها، start_url، ...)
- `sw.js` — سرویس‌ورکر برای کش آفلاین، استراتژی‌ها و fallback
- `pwa-init.js` — اسکریپت بسیار سبک برای نمایش اسپلش/لودر با آیکن، رجیستر SW، دکمه «نصب برنامه»، و کمک‌یار IndexedDB
- فایل‌های آیکن در اندازه‌های استاندارد (شامل maskable)
- `offline.html` — صفحه جایگزین در صورت قطع اینترنت

## نحوه اتصال به کد فعلی بدون تغییر ساختاری
۱) در انتهای `<body>` فایل `index.html` خود فقط یک خط اضافه کنید:
```html
<script src="/pwa-init.js"></script>
```
(سایر کدهای شما بدون تغییر باقی می‌ماند.)

۲) اگر در `<head>` لینک manifest ندارید این خط را اضافه کنید (در فایل شما وجود داشت):
```html
<link rel="manifest" href="/manifest.json">
```

۳) اگر سایت را روی دامنه/هاست استاتیک می‌گذارید، مطمئن شوید همه فایل‌ها از روت سرو می‌شود
(به‌خصوص `sw.js` باید در روت باشد تا کل اپ را پوشش دهد).

## تست PWA
- پروژه را روی یک سرور محلی با HTTPS اجرا کنید.
- صفحه را باز کنید → لودر با آیکن دیده می‌شود → بعد از بارگذاری محو می‌شود.
- DevTools > Application > Service Workers، ثبت SW را ببینید.
- DevTools > Application > Manifest، ایرادات را چک کنید.

## نکته آفلاین و ذخیره داده
- سرویس‌ورکر فایل‌های کلیدی را کش می‌کند و برای HTMLها استراتژی `network-first` با fallback به `offline.html` دارد.
- اگر قبلاً از `localStorage` استفاده می‌کنید، اسکریپت `pwa-init.js` یک بکاپ از آن را در IndexedDB ذخیره می‌کند تا امن‌تر باشد.
- برای ذخیره داده‌ی دلخواه، از هرجای اپ می‌توانید استفاده کنید:
```js
await window.AppDB.set('myKey', myValue);
const v = await window.AppDB.get('myKey');
```
(ساختار اپ شما تغییر نمی‌کند.)

## ساخت بسته اندرویدی
- آدرس سایت را منتشر کنید (HTTPS).
- وارد https://www.pwabuilder.com شوید، URL را بدهید، ایرادات را رفع کنید (اگر بود).
- سپس «Generate Android APK/AAB» را بزنید و فایل‌های خروجی را بگیرید.

